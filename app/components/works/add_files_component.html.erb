<section data-controller="complex-radio file-uploads" id="file">
  <header>Add your files *</header>

  <div class="form-check" data-complex-radio-target="selection">
    <%= form.radio_button :globus, false, class: 'form-check-input',
      data: { action: 'complex-radio#disableUnselectedInputs file-uploads#updatePanelVisibility' }
    %>
    <%= form.label :globus, 'Upload files', class: 'form-check-label fw-semibold' %>
    <div id="uploaded-files-panel" data-file-uploads-target="fileUploads">
      <p>All file types are accepted. If you have a deposit that is over 10GB, or
        have any trouble with adding your files,
        <%= link_to('contact us.', '#contactUsModal', data: {
                                  bs_toggle: 'modal',
                                  bs_target: '#contactUsModal' }) %>
      </p>
      <div data-controller="dropzone" data-dropzone-max-file-size="10000" data-dropzone-max-files="1000">
        <div data-controller="dropzone2" data-dropzone-max-file-size="10000" data-dropzone2-max-files="1000" data-dropzone2-folders=true>
          <fieldset>
            <div class="dropzone dropzone-default" data-dropzone-target="container" data-dropzone2-target="container">
              <%= form.file_field :files, multiple: true, direct_upload: true,
                                  data: { dropzone_target: 'input', dropzone2_target: 'input' } %>
              <div class="dz-message needsclick text-secondary">
                <p>Drop files here</p>
              </div>
            </div>
            <span style="margin: .7rem">or</span> <button type="button" class="dz-clickable btn btn-outline-primary">Choose files</button>
            <span style="margin: .7rem">or</span> <button type="button" class="dz-clickable-folders btn btn-outline-primary">Choose folders</button>
            <div class="invalid-feedback" data-dropzone-target="feedback" data-dropzone2-target="feedback">You must attach a file<%= error_message %></div>
            <div class="dropzone-previews" data-dropzone-target="previewsContainer" data-dropzone2-target="previewsContainer">
              <%= form.fields_for :attached_files do |file_form| %>
                <%= render Works::FileRowComponent.new(form: file_form) %>
              <% end %>
            </div>
          </fieldset>

          <template data-dropzone-target='template' data-dropzone2-target='template'>
            <%= form.fields_for :attached_files, AttachedFile.new, child_index: 'TEMPLATE_RECORD' do |file_form| %>
              <%= render Works::FileRowComponent.new(form: file_form) %>
            <% end %>
          </template>
        </div>
      </div>
    </div>
  </div>
  <div class="form-check pt-3" data-complex-radio-target="selection">
    <%= form.radio_button :globus, true, class: 'form-check-input', 'data-file-uploads-target': 'globusRadioButton',
      data: { action: 'complex-radio#disableUnselectedInputs file-uploads#updatePanelVisibility' }
    %>
    <%= form.label :globus, 'I have uploaded my files to a Globus endpoint provided to me by SDR staff.', class: 'form-check-label fw-semibold' %>
    <p><em>Only select this option if you have already discussed Globus with SDR staff.</em></p>
  </div>
</section>
